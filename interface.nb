(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    112008,       2895]
NotebookOptionsPosition[    108887,       2786]
NotebookOutlinePosition[    109399,       2806]
CellTagsIndexPosition[    109356,       2803]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Cosmomathica", " ", "version", " ", "0.2"}], ",", " ", 
   RowBox[{
   "February", " ", "2014.", " ", "By", " ", "Adrian", " ", "Vollmer"}], ",", 
   " ", 
   RowBox[{"Institute", " ", "for", " ", "theoretical", " ", "physics"}], ",",
    " ", 
   RowBox[{"University", " ", 
    RowBox[{"Heidelberg", "."}]}]}], "*)"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Preamble", "Section",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BeginPackage", "[", "\"\<cosmomathica`interface`\>\"", 
  "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"cosmomathica`interface`\"\>"], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Transfer", "::", "usage"}], "=", 
    "\"\<Transfer[OmegaM, fBaryon, Tcmb, h] provides an interface to \
Eisenstein & Hu's fitting formula for the transfer function. It takes the \
reduced total matter density \!\(\*SubscriptBox[\(\[CapitalOmega]\), \
\(M\)]\), the fraction of baryons \!\(\*SubscriptBox[\(\[CapitalOmega]\), \(b\
\)]\)/\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(M\)]\), the CMB temperature \
and the dimensionless Hubble constant as input, and returns the sound \
horizon, the wavenumber \!\(\*SubscriptBox[\(k\), \(peak\)]\) where the \
spectrum has a maximum, the transfer function for CDM, baryons, both, or with \
no baryons or no wiggles.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Halofit", "::", "usage"}], "=", 
    "\"\<Halofit[OmegaM, OmegaL, gammaShape, sigma8, ns, betaP, z0] provides \
an interface to the halofit algorithm by Robert E. Smith et al. \
(reimplemented in C by Martin Kilbinger). It takes the total matter density \
\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(M\)]\), the vacuum energy density \
\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(L\)]\), a shape factor, \
\!\(\*SubscriptBox[\(\[Sigma]\), \(8\)]\), \!\(\*SubscriptBox[\(n\), \
\(s\)]\), \!\(\*SubscriptBox[\(\[Beta]\), \(p\)]\), and a fixed redshift \!\(\
\*SubscriptBox[\(z\), \(0\)]\) as input, and returns the nonlinear matter \
power spectrum (computed in three ways: linearly with the BBKS alogorithm, \
nonlinear with the algorithm by Peacock and Dobbs, or nonlinearly with the \
Halofit algorithm) at 20 different values of the scale factor and the \
convergence power spectrum in tabulated form.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CosmicEmu", "::", "usage"}], "=", 
    "\"\<CosmicEmu[omegaM, omegaB, sigma8, ns, w] provides an interface to \
the CosmicEmulator by Earl Lawrence. It takes \
\!\(\*SubscriptBox[\(\[Omega]\), \(M\)]\), \!\(\*SubscriptBox[\(\[Omega]\), \
\(b\)]\), \!\(\*SubscriptBox[\(\[Sigma]\), \(8\)]\), \
\!\(\*SubscriptBox[\(n\), \(s\)]\), and the equation of state w, and returns \
the nonlinear matter power spectrum at five different redshifts as well as z, \
H, d (all at last scattering), and the sound horizon.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FrankenEmu", "::", "usage"}], "=", 
    "\"\<FrankenEmu[omegaM, omegaB, h, sigma8, ns, w] provides an interface \
to FrankenEmu by Earl Lawrence. It takes \!\(\*SubscriptBox[\(\[Omega]\), \(M\
\)]\), \!\(\*SubscriptBox[\(\[Omega]\), \(b\)]\), h, \!\(\*SubscriptBox[\(\
\[Sigma]\), \(8\)]\), \!\(\*SubscriptBox[\(n\), \(s\)]\), and the equation of \
state w, and returns the nonlinear matter power spectrum at five different \
redshifts as well as z, H, d (all at last scattering), and the sound horizon. \
The Hubble parameter h can also be omitted, in which case it will be \
determined from the CMB just as in CosmicEmu. Additional cosmological \
parameters are only returned if h is missing.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CAMB", "::", "usage"}], "=", 
    "\"\<CAMB[OmegaC, OmegaB, OmegaL, h, w] provides an interface to CAMB by \
Antony Lewis and Anthony Challinor. It takes a few parameters as well as a \
number of options as input, and returns various cosmological quantities. The \
distinction between parameters and options is in principle arbitrary. \
However, since some physical parameters are often assumed to take on a \
default value, they are being interpreted as an option here. To see the \
default options, type `Options[CAMB]`.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CLASS", "::", "usage"}], "=", 
    "\"\<CLASS[\\\"parameter1\\\" -> \\\"value1\\\",...] runs Class\>\""}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Copter", "::", "usage"}], "=", 
    "\"\<Copter[OmegaM, OmegaB, h, ns, sigma8, transfer, z, type] provides an \
interface to Copter by Jordan Carlson. It takes \!\(\*SubscriptBox[\(\
\[CapitalOmega]\), \(M\)]\), \!\(\*SubscriptBox[\(\[CapitalOmega]\), \
\(b\)]\), h, \!\(\*SubscriptBox[\(n\), \(s\)]\), \
\!\(\*SubscriptBox[\(\[Sigma]\), \(8\)]\), the transfer function in shape of \
a list of value pairs and returns the power spectrum and other quantities. \
The 'type' variable specifies which pertubration theory is used and must take \
one of the following values (as a string): 'SPT' (Standard PT), 'RPT' \
(Renormalized PT), 'LPT' (Lagrangian PT), 'FWT' (Flowing with time, TRG), \
'LargeN', 'HSPT' (Higher order PT), 'NW' (no wiggles, Eisenstein&Hu \
algorithm), 'Linear'. Several options can be specified.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CopterGrowth", "::", "usage"}], "=", 
   "\"\<CopterGrowth[OmegaM, OmegaB, h, ns, z] returns the growth function \
computed by Copter evaluated at each redshift contained in the list z.\>\""}],
   ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tcmb", "::", "usage"}], "=", "\"\<An option for CAMB\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"OmegaNu", "::", "usage"}], "=", "\"\<An option for CAMB\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"YHe", "::", "usage"}], "=", "\"\<An option for CAMB\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MasslessNeutrinos", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MassiveNeutrinos", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NuMassDegeneracies", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NuMassFractions", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarInitialCondition", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NonLinear", "::", "usage"}], "=", "\"\<An option for CAMB\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WantCMB", "::", "usage"}], "=", "\"\<An option for CAMB\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WantTransfer", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WantCls", "::", "usage"}], "=", "\"\<An option for CAMB\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarSpectralIndex", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarRunning", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorSpectralIndex", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RatioScalarTensorAmplitudes", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarPowerAmplitude", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PivotScalar", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PivotTensor", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DoReionization", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UseOpticalDepth", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"OpticalDepth", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ReionizationRedshift", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ReionizationFraction", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ReionizationDeltaRedshift", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TransferHighPrecision", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WantScalars", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WantVectors", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WantTensors", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WantZstar", "::", "usage"}], "=", "\"\<An option for CAMB\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WantZdrag", "::", "usage"}], "=", "\"\<An option for CAMB\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"OutputNormalization", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxEll", "::", "usage"}], "=", "\"\<An option for CAMB\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxEtaK", "::", "usage"}], "=", "\"\<An option for CAMB\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxEtaKTensor", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxEllTensor", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TransferKmax", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TransferKperLogInt", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TransferRedshifts", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AccuratePolarization", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AccurateReionization", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AccurateBB", "::", "usage"}], "=", "\"\<An option for CAMB\>\""}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DoLensing", "::", "usage"}], "=", "\"\<An option for CAMB\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"OnlyTransfers", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DerivedParameters", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MassiveNuMethod", "::", "usage"}], "=", 
   "\"\<An option for CAMB\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zInitial", "::", "usage"}], "=", 
   "\"\<Initial redshift for Copter\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Neta", "::", "usage"}], " ", "=", " ", 
   "\"\<Number of time steps for Copter\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kcut", "::", "usage"}], "=", 
   "\"\<Cutoff wavenumber for Copter\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"epsrel", "::", "usage"}], "=", 
   "\"\<Relative error for integration methods for Copter\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qmin", "::", "usage"}], "=", "\"\<qmin for Copter\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qmax", "::", "usage"}], "=", "\"\<qmax for Copter\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"order", "::", "usage"}], "=", 
   "\"\<Order for Higher order SPT for Copter\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"formula", "::", "usage"}], "=", 
   "\"\<Equation to use for No-Wiggle spectrum in Copter (must be 1, 2 or \
3)\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CAMB", "::", "Eigenstates"}], "=", 
   "\"\<NuMassEigenstates and NuMassFractions must have the same length  (can \
be zero).\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CAMB", "::", "InvalidOption"}], "=", 
   "\"\<Option `1` is '`2`', but must be one of the following: `3`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CAMB", "::", "Lists"}], "=", 
   "\"\<The following options need to be non-empty lists of the same length: \
`1`\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CAMB", "::", "Error"}], "=", 
   "\"\<CAMB exited with the following error code: `1`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Interface", "::", "LinkBroken"}], "=", 
   "\"\<`1` crashed. See if there is anything useful on stdout.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Interface", "::", "OutsideBounds"}], "=", 
   "\"\<Parameter out of bounds. `5` requires `3` <= `1` <= `4`, but you have \
`1`=`2`.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Interface", "::", "NotInstalled"}], "=", 
   "\"\<`1` appears to be unavailable on your system.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Interface", "::", "MathLinkFail"}], "=", 
   "\"\<The MathLink failed. Check if there is anything useful on \
stdout.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Copter", "::", "InvalidType"}], "=", 
   "\"\<Type is '`1`', but must be one of the following: `2`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CLASS", "::", "Error"}], "=", "\"\<`1` => `2`\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Main", "Section",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"cosmomathica`interface`Private`\"\>"], "Output"]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"$location", "=", 
   RowBox[{"DirectoryName", "[", "$InputFileName", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bool2int", "[", "b_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{"b", ",", "1", ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"validatestring", "[", 
    RowBox[{"val_", ",", "name_", ",", "poss_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"poss", ",", "val"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"CAMB", "::", "InvalidOption"}], ",", "name", ",", "val", ",", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"Riffle", "[", 
          RowBox[{"poss", ",", "\"\<, \>\""}], "]"}]}]}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"validatelimits", "[", 
    RowBox[{
    "val_", ",", "name_", ",", "lower_", ",", "upper_", ",", "module_"}], 
    "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"(", 
       RowBox[{"lower", "\[LessEqual]", "val", "\[LessEqual]", "upper"}], 
       ")"}]}], ",", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"Interface", "::", "OutsideBounds"}], ",", "name", ",", "val",
         ",", "lower", ",", "upper", ",", "module"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"validatelists", "[", "list_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"1", "!=", 
      RowBox[{"Length", "@", 
       RowBox[{"Union", "[", 
        RowBox[{"Length", "/@", "list"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"CAMB", "::", "Lists"}], ",", "list"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"validateresult", "[", 
    RowBox[{"x_", ",", "name_"}], "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{"x", ",", "$Failed", ",", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"Interface", "::", "LinkBroken"}], ",", "name"}], "]"}], ";", 
      
      RowBox[{"Abort", "[", "]"}], ";", "False"}], ",", "Null", ",", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"Interface", "::", "NotInstalled"}], ",", "name"}], "]"}], 
      "False"}], ",", "_", ",", "True"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"reshape", "[", 
   RowBox[{"list_", ",", "dimensions_"}], "]"}], ":=", 
  RowBox[{"First", "[", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
     RowBox[{"Flatten", "[", "list", "]"}], ",", 
     RowBox[{"Reverse", "[", "dimensions", "]"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["CLASS", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CLASS", "[", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "link", ",", "inifile", ",", "tempdir", ",", "result", ",", "s", ",", 
       "limits"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tempdir", "=", 
       RowBox[{"CreateDirectory", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"inifile", "=", 
       RowBox[{"tempdir", "<>", "\"\</mathematica.ini\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"inifile", ",", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"o", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\< = \>\"", "<>", 
            RowBox[{"o", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", 
             RowBox[{"{", "options", "}"}]}], "}"}]}], "]"}], "~", "Join", 
         "~", 
         RowBox[{"{", 
          RowBox[{"\"\<root = \>\"", "<>", "tempdir", "<>", "\"\</out_\>\""}],
           "}"}]}], ",", "\"\<Text\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"link", "=", 
       RowBox[{"Install", "[", 
        RowBox[{"$location", "<>", "\"\<ext/math_link\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Global`Class", "[", "inifile", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"validateresult", "[", 
       RowBox[{"result", ",", "\"\<CLASS\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Uninstall", "[", "link", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"DeleteDirectory", "[", 
       RowBox[{"tempdir", ",", 
        RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"And", "@@", 
         RowBox[{"StringQ", "/@", "result"}]}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"CLASS", "::", "Error"}], ",", 
           RowBox[{"result", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"result", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", 
         RowBox[{"Return", "[", "$Failed", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"limits", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"First", "@", "result"}], ",", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "\[Rule]", "\"\<kvalues\>\""}], ",", 
          RowBox[{
           RowBox[{"-", "2"}], "\[Rule]", "\"\<tauvalues\>\""}], ",", 
          RowBox[{
           RowBox[{"-", "3"}], "\[Rule]", "\"\<sigma8\>\""}], ",", 
          RowBox[{
           RowBox[{"-", "4"}], "\[Rule]", "\"\<transfer\>\""}], ",", 
          RowBox[{
           RowBox[{"-", "5"}], "\[Rule]", "\"\<linearPk\>\""}]}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"limits", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{"limits", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"count", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[Equal]", "1"}], ",", "0", ",", 
              RowBox[{"Total", "@", 
               RowBox[{"limits", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{";;", 
                   RowBox[{"i", "-", "1"}]}], ",", "2"}], "]"}], "]"}]}]}], 
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CLASS", "[", 
            RowBox[{"limits", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "\[Rule]", 
           RowBox[{"result", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{
               RowBox[{"count", "+", "1"}], ";;", 
               RowBox[{"count", "+", 
                RowBox[{"limits", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}]}], "]"}], 
            "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "limits"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["CAMB", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CAMB", "[", 
    RowBox[{
     RowBox[{"OmegaC_", "?", "NumericQ"}], ",", 
     RowBox[{"OmegaB_", "?", "NumericQ"}], ",", 
     RowBox[{"OmegaL_", "?", "NumericQ"}], ",", 
     RowBox[{"h_", "?", "NumericQ"}], ",", 
     RowBox[{"w_", "?", "NumericQ"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "j", ",", "link", ",", "result", ",", "resultfloat", ",", "resultint", 
       ",", "floats", ",", "ints", ",", "initialcond", ",", "nonlinear", ",", 
       "massivenu", ",", "limits", ",", "check", ",", "getDimensions", ",", 
       "dimensions", ",", "array", ",", "redshifts"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getDimensions", "[", "list_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "r"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ";", 
          RowBox[{"r", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"i", "<", 
             RowBox[{"Length", "@", "list"}]}], ",", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"r", ",", 
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ";;", 
                  RowBox[{"i", "+", 
                   RowBox[{"list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}]}], "]"}],
              ";", 
             RowBox[{"i", "=", 
              RowBox[{"i", "+", "1", "+", 
               RowBox[{"list", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "r"}]}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "some", " ", "parameters", " ", "must", " ", "be", " ", "within", " ", 
        "certain", " ", "limits"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"limits", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ReionizationFraction", ",", "0", ",", "1.5"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"OpticalDepth", ",", "0", ",", ".9"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"h", ",", "\"\<h\>\"", ",", ".2", ",", "1."}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Tcmb", ",", "2.7", ",", "2.8"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"YHe", ",", ".2", ",", ".8"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"MasslessNeutrinos", ",", "0", ",", "3.1"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"MassiveNeutrinos", "?"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "OmegaB", ",", 
           "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(B\)]\)\>\"", ",", 
           RowBox[{".001", "/", 
            RowBox[{"h", "^", "2"}]}], ",", 
           RowBox[{"1.", "/", 
            RowBox[{"h", "^", "2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "OmegaC", " ", ",", 
           "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(C\)]\)\>\"", ",", 
           RowBox[{"0.", "/", 
            RowBox[{"h", "^", "2"}]}], ",", 
           RowBox[{"3.", "/", 
            RowBox[{"h", "^", "2"}]}]}], "}"}]}], "\[IndentingNewLine]", 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"validatelists", "[", 
       RowBox[{"OptionValue", "@", 
        RowBox[{"{", 
         RowBox[{
         "ScalarSpectralIndex", ",", "ScalarRunning", ",", 
          "TensorSpectralIndex", ",", "RatioScalarTensorAmplitudes", ",", 
          "ScalarPowerAmplitude"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"validatelists", "[", 
       RowBox[{"OptionValue", "@", 
        RowBox[{"{", 
         RowBox[{"NuMassDegeneracies", ",", "NuMassFractions"}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"validatelimits", "[", 
         RowBox[{
          RowBox[{"Sequence", "@@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NumericQ", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "#", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"OptionValue", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], "~", "Join",
               "~", 
              RowBox[{"Rest", "@", "#"}]}]}], "]"}]}], ",", "\"\<CAMB\>\""}], 
         "]"}], "&"}], "/@", "limits"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"initialcond", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<vector\>\"", ",", "\"\<adiabatic\>\"", ",", "\"\<iso_CDM\>\"", 
         ",", "\"\<iso_baryon\>\"", ",", "\"\<iso_neutrino\>\"", ",", 
         "\"\<iso_neutrino_vel\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nonlinear", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<none\>\"", ",", "\"\<pk\>\"", ",", "\"\<lens\>\"", ",", 
         "\"\<both\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"massivenu", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<int\>\"", ",", "\"\<trunc\>\"", ",", "\"\<approx\>\"", ",", 
         "\"\<best\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"validatestring", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "ScalarInitialCondition", "]"}], ",", 
        "\"\<ScalarInitialCondition\>\"", ",", "initialcond"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"validatestring", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "NonLinear", "]"}], ",", 
        "\"\<NonLinear\>\"", ",", "nonlinear"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"validatestring", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "MassiveNuMethod", "]"}], ",", 
        "\"\<MassiveNuMethod\>\"", ",", "massivenu"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"floats", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{"OmegaC", ",", "OmegaB", ",", "OmegaL", ",", 
          RowBox[{"h", "*", "100"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "OmegaNu", ",", "Tcmb", ",", "YHe", ",", "MasslessNeutrinos", ",",
              "NuMassDegeneracies", ",", "NuMassFractions", ",", 
             "ScalarSpectralIndex", ",", "ScalarRunning", ",", 
             "TensorSpectralIndex", ",", "RatioScalarTensorAmplitudes", ",", 
             "ScalarPowerAmplitude", ",", "PivotScalar", ",", "PivotTensor", 
             ",", "OpticalDepth", ",", "ReionizationRedshift", ",", 
             "ReionizationFraction", ",", "ReionizationDeltaRedshift", ",", 
             "MaxEtaK", ",", "MaxEtaKTensor", ",", "TransferKmax"}], "}"}]}], 
          ",", 
          RowBox[{"Reverse", "@", 
           RowBox[{"Sort", "@", 
            RowBox[{"OptionValue", "@", "TransferRedshifts"}]}]}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ints", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"OptionValue", "[", "MassiveNeutrinos", "]"}], ",", 
          RowBox[{"Length", "@", 
           RowBox[{"OptionValue", "[", "NuMassFractions", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"initialcond", ",", 
              RowBox[{"OptionValue", "[", "ScalarInitialCondition", "]"}]}], 
             "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"nonlinear", ",", 
              RowBox[{"OptionValue", "[", "NonLinear", "]"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}], ",", 
          RowBox[{"Length", "@", 
           RowBox[{"OptionValue", "@", "ScalarSpectralIndex"}]}], ",", 
          RowBox[{"bool2int", "/@", 
           RowBox[{"OptionValue", "@", 
            RowBox[{"{", 
             RowBox[{
             "DoReionization", ",", "UseOpticalDepth", ",", 
              "TransferHighPrecision", ",", "WantCMB", ",", "WantTransfer", 
              ",", "WantCls", ",", "WantScalars", ",", "WantVectors", ",", 
              "WantTensors", ",", "WantZstar", ",", " ", "WantZdrag"}], 
             "}"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "OutputNormalization", ",", "MaxEll", ",", "MaxEllTensor", ",", 
             "TransferKperLogInt"}], "}"}]}], ",", 
          RowBox[{"Length", "@", 
           RowBox[{"OptionValue", "@", "TransferRedshifts"}]}], ",", 
          RowBox[{"bool2int", "/@", 
           RowBox[{"OptionValue", "@", 
            RowBox[{"{", 
             RowBox[{
             "AccuratePolarization", ",", "AccurateReionization", ",", 
              "AccurateBB", ",", "DoLensing", ",", "OnlyTransfers", ",", 
              "DerivedParameters"}], "}"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"massivenu", ",", 
              RowBox[{"OptionValue", "[", "MassiveNuMethod", "]"}]}], "]"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"ints", ",", "floats"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"SetDirectory", "[", 
       RowBox[{"$location", "<>", "\"\<ext/camb\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"link", "=", 
       RowBox[{"Install", "[", 
        RowBox[{"$location", "<>", "\"\<ext/math_link\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Global`CAMBrun", "[", 
        RowBox[{
         RowBox[{"N", "/@", "floats"}], ",", "ints"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ResetDirectory", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"validateresult", "[", 
          RowBox[{"result", ",", "\"\<CAMB\>\""}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Return", "[", "$Failed", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Uninstall", "[", "link", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"resultfloat", ",", "resultint"}], "}"}], "=", "result"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"resultint", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"CAMB", "::", "Error"}], ",", 
           RowBox[{"resultint", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
         RowBox[{"Return", "[", "$Failed", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"resultint", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"resultint", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"dimensions", "=", 
       RowBox[{"getDimensions", "@", "resultint"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"array", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"resultfloat", ",", 
            RowBox[{"Times", "@@", "d"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"resultfloat", "=", 
          RowBox[{"Drop", "[", 
           RowBox[{"resultfloat", ",", 
            RowBox[{"Times", "@@", "d"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"resultfloat", ",", 
           RowBox[{"reshape", "[", 
            RowBox[{"array", ",", "d"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "dimensions"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"j", "=", "2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"CAMB", "[", "\"\<age\>\"", "]"}], "\[Rule]", 
           RowBox[{"resultfloat", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CAMB", "[", "\"\<zstar\>\"", "]"}], "\[Rule]", 
           RowBox[{"resultfloat", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CAMB", "[", "\"\<rstar\>\"", "]"}], "\[Rule]", 
           RowBox[{"resultfloat", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CAMB", "[", "\"\<100thetastar\>\"", "]"}], "\[Rule]", 
           RowBox[{"resultfloat", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CAMB", "[", "\"\<zdrag\>\"", "]"}], "\[Rule]", 
           RowBox[{"resultfloat", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "5"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CAMB", "[", "\"\<rdrag\>\"", "]"}], "\[Rule]", 
           RowBox[{"resultfloat", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "6"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CAMB", "[", "\"\<kD\>\"", "]"}], "\[Rule]", 
           RowBox[{"resultfloat", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "7"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CAMB", "[", "\"\<100thetaD\>\"", "]"}], "\[Rule]", 
           RowBox[{"resultfloat", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "8"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CAMB", "[", "\"\<zEQ\>\"", "]"}], "\[Rule]", 
           RowBox[{"resultfloat", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "9"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CAMB", "[", "\"\<100thetaEQ\>\"", "]"}], "\[Rule]", 
           RowBox[{"resultfloat", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "10"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CAMB", "[", "\"\<sigma8\>\"", "]"}], "->", 
           RowBox[{"resultfloat", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "WantScalars", "]"}], ",", 
            RowBox[{
             RowBox[{"CAMB", "[", "\"\<CLscalar\>\"", "]"}], "\[Rule]", 
             RowBox[{"Transpose", "@", 
              RowBox[{"First", "@", 
               RowBox[{"Transpose", "[", 
                RowBox[{"resultfloat", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "++"}], "]"}], "]"}], "]"}]}]}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "WantVectors", "]"}], ",", 
            RowBox[{
             RowBox[{"CAMB", "[", "\"\<CLvector\>\"", "]"}], "\[Rule]", 
             RowBox[{"Transpose", "@", 
              RowBox[{"First", "@", 
               RowBox[{"Transpose", "[", 
                RowBox[{"resultfloat", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "++"}], "]"}], "]"}], "]"}]}]}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "WantTensors", "]"}], ",", 
            RowBox[{
             RowBox[{"CAMB", "[", "\"\<CLtensor\>\"", "]"}], "->", 
             RowBox[{"Transpose", "@", 
              RowBox[{"First", "@", 
               RowBox[{"Transpose", "[", 
                RowBox[{"resultfloat", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "++"}], "]"}], "]"}], "]"}]}]}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "WantTransfer", "]"}], ",", 
            RowBox[{
             RowBox[{"CAMB", "[", "\"\<redshifts\>\"", "]"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"redshifts", "=", 
               RowBox[{"resultfloat", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "2"}], "]"}], "]"}]}], ")"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "WantTransfer", "]"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{
              RowBox[{"Flatten", "@", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"CAMB", "[", "\"\<PSlinear\>\"", "]"}], "\[Rule]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Exp", "@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"resultfloat", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"resultfloat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"j", "+", "1"}], ",", "All", ",", "k"}], "]"}], 
                    "]"}]}], "}"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"Length", "@", "redshifts"}]}], "}"}]}], "]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"CAMB", "[", "\"\<PSnonlinear\>\"", "]"}], 
                  "\[Rule]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Exp", "@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"resultfloat", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"resultfloat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"j", "+", "2"}], ",", "All", ",", "k"}], "]"}], 
                    "]"}]}], "}"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"Length", "@", "redshifts"}]}], "}"}]}], 
                   "\[IndentingNewLine]", "]"}]}]}], "}"}]}], "~", "Join", 
              "~", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CAMB", "[", "\"\<Transfer\>\"", "]"}], "\[Rule]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"resultfloat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"j", "+", "3"}], ",", "All", ",", "All", ",", 
                    "k"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"Length", "@", "redshifts"}]}], "}"}]}], "]"}]}], 
               "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{
            RowBox[{"CAMB", "[", "\"\<ints\>\"", "]"}], "->", "resultint"}], 
           ",", 
           RowBox[{
            RowBox[{"CAMB", "[", "\"\<floats\>\"", "]"}], "->", 
            "resultfloat"}]}], "*)"}], "\[IndentingNewLine]", "}"}], ",", 
        "Null"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "CAMB", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Tcmb", "\[Rule]", "2.7255"}], ",", 
     RowBox[{"OmegaNu", "\[Rule]", "0"}], ",", 
     RowBox[{"YHe", "\[Rule]", ".24"}], ",", 
     RowBox[{"MasslessNeutrinos", "\[Rule]", "3.046"}], ",", 
     RowBox[{"MassiveNeutrinos", "\[Rule]", "0"}], ",", 
     RowBox[{"NuMassDegeneracies", "\[Rule]", 
      RowBox[{"{", "0", "}"}]}], ",", 
     RowBox[{"NuMassFractions", "\[Rule]", 
      RowBox[{"{", "1", "}"}]}], ",", 
     RowBox[{"ScalarInitialCondition", "\[Rule]", "\"\<adiabatic\>\""}], ",", 
     
     RowBox[{"NonLinear", "\[Rule]", "\"\<none\>\""}], ",", 
     RowBox[{"WantCMB", "\[Rule]", "True"}], ",", 
     RowBox[{"WantTransfer", "\[Rule]", "True"}], ",", 
     RowBox[{"WantCls", "\[Rule]", "True"}], ",", 
     RowBox[{"ScalarSpectralIndex", "\[Rule]", 
      RowBox[{"{", ".96", "}"}]}], ",", 
     RowBox[{"ScalarRunning", "\[Rule]", 
      RowBox[{"{", "0", "}"}]}], ",", 
     RowBox[{"TensorSpectralIndex", "\[Rule]", 
      RowBox[{"{", "0", "}"}]}], ",", 
     RowBox[{"RatioScalarTensorAmplitudes", "\[Rule]", 
      RowBox[{"{", "1", "}"}]}], ",", 
     RowBox[{"ScalarPowerAmplitude", "\[Rule]", 
      RowBox[{"{", "2.1*^-9", "}"}]}], ",", 
     RowBox[{"PivotScalar", "\[Rule]", ".05"}], ",", 
     RowBox[{"PivotTensor", "\[Rule]", ".05"}], ",", 
     RowBox[{"DoReionization", "\[Rule]", "True"}], ",", 
     RowBox[{"UseOpticalDepth", "\[Rule]", "False"}], ",", 
     RowBox[{"OpticalDepth", "\[Rule]", "0."}], ",", 
     RowBox[{"ReionizationRedshift", "\[Rule]", "10."}], ",", 
     RowBox[{"ReionizationFraction", "\[Rule]", "1."}], ",", 
     RowBox[{"ReionizationDeltaRedshift", "\[Rule]", ".5"}], ",", 
     RowBox[{"TransferHighPrecision", "\[Rule]", "False"}], ",", 
     RowBox[{"WantScalars", "\[Rule]", "True"}], ",", 
     RowBox[{"WantVectors", "\[Rule]", "True"}], ",", 
     RowBox[{"WantTensors", "\[Rule]", "True"}], ",", 
     RowBox[{"WantZstar", "\[Rule]", "True"}], ",", " ", 
     RowBox[{"WantZdrag", "\[Rule]", "True"}], ",", 
     RowBox[{"OutputNormalization", "\[Rule]", "1"}], ",", 
     RowBox[{"MaxEll", "\[Rule]", "1500"}], ",", 
     RowBox[{"MaxEtaK", "\[Rule]", "3000."}], ",", 
     RowBox[{"MaxEtaKTensor", "\[Rule]", "800."}], ",", 
     RowBox[{"MaxEllTensor", "\[Rule]", "400"}], ",", 
     RowBox[{"TransferKmax", "\[Rule]", ".9"}], ",", 
     RowBox[{"TransferKperLogInt", "\[Rule]", "0"}], ",", 
     RowBox[{"TransferRedshifts", "\[Rule]", 
      RowBox[{"{", "0.", "}"}]}], ",", 
     RowBox[{"AccuratePolarization", "\[Rule]", "True"}], ",", 
     RowBox[{"AccurateReionization", "\[Rule]", "False"}], ",", 
     RowBox[{"AccurateBB", "\[Rule]", "False"}], ",", 
     RowBox[{"DoLensing", "\[Rule]", "True"}], ",", 
     RowBox[{"OnlyTransfers", "\[Rule]", "False"}], ",", 
     RowBox[{"DerivedParameters", "\[Rule]", "True"}], ",", 
     RowBox[{"MassiveNuMethod", "\[Rule]", "\"\<best\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "validatestring", "]"}], "=", 
   RowBox[{"Options", "[", "CAMB", "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Transfer", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Transfer", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Transfer", "[", 
     RowBox[{
      RowBox[{"OmegaM_", "?", "NumericQ"}], ",", 
      RowBox[{"fBaryon_", "?", "NumericQ"}], ",", 
      RowBox[{"Tcmb_", "?", "NumericQ"}], ",", 
      RowBox[{"h_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", "link", ",", "krange", ",", "fitonek", ",", "horizon", 
        ",", "peak", ",", "OmegaC"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"validatelimits", "[", 
        RowBox[{
        "fBaryon", ",", "\"\<fBaryon\>\"", ",", ".0001", ",", "1", ",", 
         "\"\<Transfer\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"OmegaC", "=", 
        RowBox[{"OmegaM", "-", 
         RowBox[{"fBaryon", "*", "OmegaM"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"link", "=", 
        RowBox[{"Install", "[", 
         RowBox[{"$location", "<>", "\"\<ext/math_link\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "These", " ", "random", " ", "factors", " ", "of", " ", "h", " ", 
         "are", " ", 
         RowBox[{"ridiculous", ".", " ", "Read"}], " ", "the", " ", 
         "comments", " ", "in", " ", "the", " ", "source", " ", 
         RowBox[{"(", 
          RowBox[{"tf", ".", "c"}], ")"}], " ", "very", " ", "carefully"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Global`TFSetParameters", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"N", "@", "OmegaM"}], "*", 
          RowBox[{"h", "^", "2"}]}], ",", 
         RowBox[{"N", "@", "fBaryon"}], ",", 
         RowBox[{"N", "@", "Tcmb"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"horizon", "=", 
        RowBox[{"Global`TFSoundHorizon", "[", 
         RowBox[{
          RowBox[{"N", "@", "OmegaM"}], ",", 
          RowBox[{"N", "@", "fBaryon"}], ",", 
          RowBox[{"N", "@", "h"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"peak", "=", 
        RowBox[{"Global`TFkPeak", "[", 
         RowBox[{
          RowBox[{"N", "@", "OmegaM"}], ",", 
          RowBox[{"N", "@", "fBaryon"}], ",", 
          RowBox[{"N", "@", "h"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"validateresult", "[", 
           RowBox[{"horizon", ",", "\"\<transfer\>\""}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Return", "[", "$Failed", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fitonek", "[", "k_", "]"}], ":=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Global`TFFitOneK", "[", 
           RowBox[{"k", "*", 
            RowBox[{"N", "@", "h"}]}], "]"}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Global`TFNoWiggles", "[", 
             RowBox[{
              RowBox[{"N", "@", "OmegaM"}], ",", 
              RowBox[{"N", "@", "fBaryon"}], ",", 
              RowBox[{"N", "@", "h"}], ",", 
              RowBox[{"N", "@", "Tcmb"}], ",", "k"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Global`TFZeroBaryon", "[", 
             RowBox[{
              RowBox[{"N", "@", "OmegaM"}], ",", 
              RowBox[{"N", "@", "h"}], ",", 
              RowBox[{"N", "@", "Tcmb"}], ",", "k"}], "]"}]}], "}"}]}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"krange", "=", 
        RowBox[{"10", "^", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "6."}], ",", "4.", ",", ".01"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"fitonek", "/@", "krange"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Uninstall", "[", "link", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Transfer", "[", "\"\<soundhorizon\>\"", "]"}], "->", 
          "horizon"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transfer", "[", "\"\<peak\>\"", "]"}], "->", "peak"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transfer", "[", "\"\<kvalues\>\"", "]"}], "\[Rule]", 
          "krange"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transfer", "[", "\"\<full\>\"", "]"}], "\[Rule]", 
          RowBox[{"result", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transfer", "[", "\"\<baryon\>\"", "]"}], "\[Rule]", 
          RowBox[{"result", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transfer", "[", "\"\<cdm\>\"", "]"}], "\[Rule]", 
          RowBox[{"result", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transfer", "[", "\"\<nowiggles\>\"", "]"}], "\[Rule]", 
          RowBox[{"result", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transfer", "[", "\"\<zerobaryons\>\"", "]"}], "\[Rule]", 
          RowBox[{"result", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Halofit", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Halofit", "[", 
    RowBox[{
     RowBox[{"OmegaM_", "?", "NumericQ"}], ",", 
     RowBox[{"OmegaL_", "?", "NumericQ"}], ",", 
     RowBox[{"gammaShape_", "?", "NumericQ"}], ",", 
     RowBox[{"sigma8_", "?", "NumericQ"}], ",", 
     RowBox[{"ns_", "?", "NumericQ"}], ",", 
     RowBox[{"betaP_", "?", "NumericQ"}], ",", 
     RowBox[{"z0_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"link", ",", 
       RowBox[{"Tf", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Kappa", "=", 
        RowBox[{"{", "}"}]}], ",", "arange", ",", "krange", ",", "ellrange", 
       ",", "labels", ",", "limits", ",", "parameters", ",", "check"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"link", "=", 
       RowBox[{"Install", "[", 
        RowBox[{"$location", "<>", "\"\<ext/math_link\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"arange", "=", 
       RowBox[{
        RowBox[{"Most", "[", 
         RowBox[{"10", "^", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "0", ",", ".1"}], "]"}]}], "]"}], "~", 
        "Join", "~", 
        RowBox[{"{", ".99999", "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"krange", "=", 
       RowBox[{
        RowBox[{"10", "^", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "4"}], ",", "4", ",", ".1"}], "]"}]}], "*", 
        "2998"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"halofit", " ", "uses", " ", "units", " ", "c", " ", 
        RowBox[{"Mpc", "/", "h"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ellrange", "=", 
       RowBox[{"10", "^", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "6", ",", ".1"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"labels", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(M\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(b\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Sigma]\), \(8\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(n\), \(s\)]\)\>\"", ",", "\"\<Gamma\>\"", 
         ",", "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(p\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(z\), \(0\)]\)\>\""}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"limits", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{".1", ",", "1.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".1", ",", "1.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".1", ",", "1.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".7", ",", "1.3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.05", ",", ".5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.0", ",", "2.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".2", ",", "1.5"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "these", " ", "are", " ", "soft", " ", "limits", " ", "as", " ", 
         "given", " ", "by", " ", "the", " ", "authors", " ", "of", " ", 
         "halofit"}], "+", 
        RowBox[{
         RowBox[{".", " ", "Results"}], " ", "may", " ", "not", " ", "be", 
         " ", "reliable", " ", "if", " ", "parameters", " ", "are", " ", 
         "outside", " ", "these", " ", "bounds"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"parameters", "=", 
       RowBox[{"{", 
        RowBox[{
        "OmegaM", ",", "OmegaL", ",", "sigma8", ",", "ns", ",", "gammaShape", 
         ",", "betaP", ",", "z0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"check", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], "<=", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<=", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"parameters", ",", "limits"}], "}"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"check", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"Interface", "::", "OutsideBounds"}], ",", 
            RowBox[{"labels", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"parameters", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"limits", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"limits", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "\"\<Halofit\>\""}],
            "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "check"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"And", "@@", "check"}]}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Global`HFSetParameters", "[", 
          RowBox[{
           RowBox[{"N", "@", "OmegaM"}], ",", 
           RowBox[{"N", "@", "OmegaL"}], ",", 
           RowBox[{"N", "@", "gammaShape"}], ",", 
           RowBox[{"N", "@", "sigma8"}], ",", 
           RowBox[{"N", "@", "ns"}], ",", 
           RowBox[{"N", "@", "betaP"}], ",", 
           RowBox[{"N", "@", "z0"}], ",", "i"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"Tf", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Global`HFGetPkNL", "[", 
              RowBox[{"a", ",", "k"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "arange"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "krange"}], "}"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"Kappa", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Global`HFGetKappa", "[", "ell", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ell", ",", "ellrange"}], "}"}]}], "]"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"validateresult", "[", 
       RowBox[{
        RowBox[{"Global`HFGetKappa", "[", "10.", "]"}], ",", 
        "\"\<halofit\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Uninstall", "[", "link", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arange", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "=", "1."}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Just", " ", "return", " ", "the", " ", "raw", " ", "numbers"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Halofit", "[", "\"\<avalues\>\"", "]"}], "\[Rule]", 
         "arange"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Halofit", "[", "\"\<kvalues\>\"", "]"}], "\[Rule]", 
         "krange"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Halofit", "[", "\"\<ellvalues\>\"", "]"}], "\[Rule]", 
         "ellrange"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Halofit", "[", "\"\<kappaBBKS\>\"", "]"}], "\[Rule]", 
         RowBox[{"Kappa", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Halofit", "[", "\"\<BBKS\>\"", "]"}], "\[Rule]", 
         RowBox[{"Tf", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Halofit", "[", "\"\<kappaPD96\>\"", "]"}], "\[Rule]", 
         RowBox[{"Kappa", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Halofit", "[", "\"\<PD96\>\"", "]"}], "\[Rule]", 
         RowBox[{"Tf", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Halofit", "[", "\"\<kappaHalofit\>\"", "]"}], "\[Rule]", 
         RowBox[{"Kappa", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Halofit", "[", "\"\<Halofit\>\"", "]"}], "\[Rule]", 
         RowBox[{"Tf", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["CosmicEmu", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CosmicEmu", "[", 
    RowBox[{
     RowBox[{"omegaM_", "?", "NumericQ"}], ",", 
     RowBox[{"omegaB_", "?", "NumericQ"}], ",", 
     RowBox[{"sigma8_", "?", "NumericQ"}], ",", 
     RowBox[{"ns_", "?", "NumericQ"}], ",", 
     RowBox[{"w_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "link", ",", "result", ",", "labels", ",", "limits", ",", "parameters", 
       ",", "check", ",", "arange"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"labels", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(M\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(b\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Sigma]\), \(8\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(n\), \(s\)]\)\>\"", ",", "\"\<w\>\""}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"limits", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{".12", ",", ".155"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".0214", ",", ".0235"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".61", ",", ".9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".85", ",", "1.05"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.3"}], ",", 
           RowBox[{"-", ".7"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "these", " ", "are", " ", "hard", " ", "limits", " ", "as", " ", 
         "given", " ", "by", " ", "the", " ", "authors", " ", "of", " ", 
         "the", " ", "cosmic", " ", "emulator"}], " ", "-", " ", 
        RowBox[{
        "the", " ", "program", " ", "will", " ", "crash", " ", "if", " ", 
         "any", " ", "parameter", " ", "is", " ", "outside", " ", "its", " ", 
         "bounds"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"parameters", "=", 
       RowBox[{"{", 
        RowBox[{"omegaM", ",", "omegaB", ",", "sigma8", ",", "ns", ",", "w"}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"arange", "=", 
       RowBox[{"Range", "[", 
        RowBox[{".5", ",", "1.", ",", ".1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"check", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], "<=", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<=", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"parameters", ",", "limits"}], "}"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"check", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"Interface", "::", "OutsideBounds"}], ",", 
            RowBox[{"labels", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"parameters", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"limits", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"limits", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
            "\"\<CosmicEmu\>\""}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "check"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"And", "@@", "check"}]}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"link", "=", 
       RowBox[{"Install", "[", 
        RowBox[{"$location", "<>", "\"\<ext/math_link\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"Partition", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "/", "2"}]}], "]"}]}], 
             ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "@", 
          RowBox[{"Global`CEGetPkNL", "[", 
           RowBox[{
            RowBox[{"N", "@", "omegaM"}], ",", 
            RowBox[{"N", "@", "omegaB"}], ",", 
            RowBox[{"N", "@", "ns"}], ",", 
            RowBox[{"N", "@", "sigma8"}], ",", 
            RowBox[{"N", "@", "w"}], ",", 
            RowBox[{
             RowBox[{"1", "/", "a"}], "-", "1"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "arange"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "CosmicEmu", " ", "only", " ", "does", " ", "these", " ", "five", " ",
          "redshifts"}], ",", " ", 
        RowBox[{"everything", " ", "else", " ", "is", " ", "interpolated"}]}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"validateresult", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"result", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], ",", "\"\<CosmicEmu\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Uninstall", "[", "link", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Just", " ", "return", " ", "the", " ", "raw", " ", "numbers"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"CosmicEmu", "[", "\"\<zvalues\>\"", "]"}], "\[Rule]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "a"}], "-", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "arange"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CosmicEmu", "[", "\"\<pk\>\"", "]"}], "->", 
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CosmicEmu", "[", "\"\<soundhorizon\>\"", "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"result", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CosmicEmu", "[", "\"\<zlss\>\"", "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"result", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CosmicEmu", "[", "\"\<dlss\>\"", "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"result", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CosmicEmu", "[", "\"\<hubblecmb\>\"", "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"result", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "4"}], "]"}], "]"}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["FrankenEmu", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FrankenEmu", "[", 
    RowBox[{
     RowBox[{"omegaM_", "?", "NumericQ"}], ",", 
     RowBox[{"omegaB_", "?", "NumericQ"}], ",", 
     RowBox[{"h_", "?", "NumericQ"}], ",", 
     RowBox[{"sigma8_", "?", "NumericQ"}], ",", 
     RowBox[{"ns_", "?", "NumericQ"}], ",", 
     RowBox[{"w_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "link", ",", "result", ",", "labels", ",", "limits", ",", "parameters", 
       ",", "check", ",", " ", "arange"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"arange", "=", 
       RowBox[{"Range", "[", 
        RowBox[{".2", ",", "1.", ",", ".1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"labels", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(M\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(b\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Sigma]\), \(8\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(n\), \(s\)]\)\>\"", ",", "\"\<w\>\"", ",", 
         "\"\<h\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"limits", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{".12", ",", ".155"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".0215", ",", ".0235"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".6", ",", ".9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".85", ",", "1.05"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.3"}], ",", 
           RowBox[{"-", ".7"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".55", ",", ".85"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "these", " ", "are", " ", "hard", " ", "limits", " ", "as", " ", 
         "given", " ", "by", " ", "the", " ", "authors", " ", "of", " ", 
         "the", " ", "cosmic", " ", "emulator"}], " ", "-", " ", 
        RowBox[{
        "the", " ", "program", " ", "will", " ", "crash", " ", "if", " ", 
         "any", " ", "parameter", " ", "is", " ", "outside", " ", "its", " ", 
         "bounds"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"parameters", "=", 
       RowBox[{"{", 
        RowBox[{
        "omegaM", ",", "omegaB", ",", "sigma8", ",", "ns", ",", "w", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"h", "<", "0"}], ",", ".7", ",", "h"}], "]"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"check", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], "<=", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<=", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"parameters", ",", "limits"}], "}"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"check", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"Interface", "::", "OutsideBounds"}], ",", 
            RowBox[{"labels", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"parameters", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"limits", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"limits", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
            "\"\<FrankenEmu\>\""}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "check"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"And", "@@", "check"}]}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"link", "=", 
       RowBox[{"Install", "[", 
        RowBox[{"$location", "<>", "\"\<ext/math_link2\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"Partition", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "/", "2"}]}], "]"}]}], 
             ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "@", 
          RowBox[{"Global`FrankenCEGetPkNL", "[", 
           RowBox[{
            RowBox[{"N", "@", "omegaM"}], ",", 
            RowBox[{"N", "@", "omegaB"}], ",", 
            RowBox[{"N", "@", "h"}], ",", 
            RowBox[{"N", "@", "ns"}], ",", 
            RowBox[{"N", "@", "sigma8"}], ",", 
            RowBox[{"N", "@", "w"}], ",", 
            RowBox[{
             RowBox[{"1", "/", "a"}], "-", "1"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "arange"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "CosmicEmu", " ", "only", " ", "does", " ", "these", " ", "five", " ",
          "redshifts"}], ",", " ", 
        RowBox[{"everything", " ", "else", " ", "is", " ", "interpolated"}]}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"validateresult", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}], ",", 
        "\"\<FrankenEmu\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Uninstall", "[", "link", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Just", " ", "return", " ", "the", " ", "raw", " ", "numbers"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"FrankenEmu", "[", "\"\<zvalues\>\"", "]"}], "\[Rule]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "a"}], "-", "1"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "arange"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FrankenEmu", "[", "\"\<pk\>\"", "]"}], "->", 
          RowBox[{"result", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "}"}], "~", "Join", 
       "~", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"h", "<", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"FrankenEmu", "[", "\"\<soundhorizon\>\"", "]"}], 
            "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"result", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FrankenEmu", "[", "\"\<zlss\>\"", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"result", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FrankenEmu", "[", "\"\<dlss\>\"", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"result", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FrankenEmu", "[", "\"\<hubblecmb\>\"", "]"}], "\[Rule]", 
            
            RowBox[{
             RowBox[{"(", 
              RowBox[{"result", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "4"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FrankenEmu", "[", 
    RowBox[{
     RowBox[{"omegaM_", "?", "NumericQ"}], ",", 
     RowBox[{"omegaB_", "?", "NumericQ"}], ",", 
     RowBox[{"sigma8_", "?", "NumericQ"}], ",", 
     RowBox[{"ns_", "?", "NumericQ"}], ",", 
     RowBox[{"w_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"FrankenEmu", "[", 
    RowBox[{"omegaM", ",", "omegaB", ",", 
     RowBox[{"-", "1."}], ",", "sigma8", ",", "ns", ",", "w"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Copter", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Copter", "[", 
    RowBox[{
    "OmegaM_", ",", "OmegaB_", ",", "h_", ",", "ns_", ",", "sigma8_", ",", 
     "transfer_", ",", "z_", ",", "type_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"link", ",", "result", ",", "return", ",", "kmax"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kmax", "=", "1.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"link", "=", 
       RowBox[{"Install", "[", 
        RowBox[{"$location", "<>", "\"\<ext/math_link\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"return", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"type", ",", "\[IndentingNewLine]", "\"\<RPT\>\"", ",", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"Global`CopterRpt", "[", 
            RowBox[{
             RowBox[{"N", "@", "h"}], ",", 
             RowBox[{"N", "@", "ns"}], ",", 
             RowBox[{"N", "@", "OmegaM"}], ",", 
             RowBox[{"N", "@", "OmegaB"}], ",", 
             RowBox[{"N", "@", "sigma8"}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"OptionValue", "@", "zInitial"}]}], ",", 
             RowBox[{"N", "@", "z"}], ",", 
             RowBox[{"OptionValue", "@", "Neta"}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"OptionValue", "@", "kcut"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"result", "\[Equal]", "$Failed"}], ",", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{"Interface", "::", "MathLinkFail"}], "]"}], ";", 
             RowBox[{"Return", "[", "$Failed", "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Partition", "[", 
             RowBox[{"result", ",", "3"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P11\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P12\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P22\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<SPT\>\"", ",", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"Global`CopterSpt", "[", 
            RowBox[{
             RowBox[{"N", "@", "h"}], ",", 
             RowBox[{"N", "@", "ns"}], ",", 
             RowBox[{"N", "@", "OmegaM"}], ",", 
             RowBox[{"N", "@", "OmegaB"}], ",", 
             RowBox[{"N", "@", "sigma8"}], ",", 
             RowBox[{"N", "@", "z"}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"OptionValue", "@", "epsrel"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"result", "\[Equal]", "$Failed"}], ",", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{"Interface", "::", "MathLinkFail"}], "]"}], ";", 
             RowBox[{"Return", "[", "$Failed", "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Partition", "[", 
             RowBox[{"result", ",", "4"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P11\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P12\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P22\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<1L-Propagator\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<LPT\>\"", ",", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"Global`CopterLpt", "[", 
            RowBox[{
             RowBox[{"N", "@", "h"}], ",", 
             RowBox[{"N", "@", "ns"}], ",", 
             RowBox[{"N", "@", "OmegaM"}], ",", 
             RowBox[{"N", "@", "OmegaB"}], ",", 
             RowBox[{"N", "@", "sigma8"}], ",", 
             RowBox[{"N", "@", "z"}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"OptionValue", "@", "epsrel"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"result", "\[Equal]", "$Failed"}], ",", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{"Interface", "::", "MathLinkFail"}], "]"}], ";", 
             RowBox[{"Return", "[", "$Failed", "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Partition", "[", 
             RowBox[{"result", ",", "4"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P22\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P13\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<1L-Propagator\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<LargeN\>\"", ",", 
         
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"Global`CopterLargeN", "[", 
            RowBox[{
             RowBox[{"N", "@", "h"}], ",", 
             RowBox[{"N", "@", "ns"}], ",", 
             RowBox[{"N", "@", "OmegaM"}], ",", 
             RowBox[{"N", "@", "OmegaB"}], ",", 
             RowBox[{"N", "@", "sigma8"}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"OptionValue", "@", "zInitial"}]}], ",", 
             RowBox[{"N", "@", "z"}], ",", "20", ",", 
             RowBox[{"N", "@", 
              RowBox[{"OptionValue", "@", "epsrel"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"result", "\[Equal]", "$Failed"}], ",", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{"Interface", "::", "MathLinkFail"}], "]"}], ";", 
             RowBox[{"Return", "[", "$Failed", "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Partition", "[", 
             RowBox[{"result", ",", "7"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P11\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P12\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P22\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<Sigma11\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<Sigma12\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<Sigma21\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<Sigma22\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<HSPT\>\"", ",", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"Global`CopterHspt", "[", 
            RowBox[{
             RowBox[{"N", "@", "h"}], ",", 
             RowBox[{"N", "@", "ns"}], ",", 
             RowBox[{"N", "@", "OmegaM"}], ",", 
             RowBox[{"N", "@", "OmegaB"}], ",", 
             RowBox[{"N", "@", "sigma8"}], ",", 
             RowBox[{"N", "@", "z"}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"OptionValue", "@", "qmin"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"OptionValue", "@", "qmax"}]}], ",", 
             RowBox[{"OptionValue", "@", "order"}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"result", "\[Equal]", "$Failed"}], ",", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{"Interface", "::", "MathLinkFail"}], "]"}], ";", 
             RowBox[{"Return", "[", "$Failed", "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Partition", "[", 
             RowBox[{"result", ",", "4"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P1\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P2\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P3\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<FWT\>\"", ",", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"Global`CopterFWT", "[", 
            RowBox[{
             RowBox[{"N", "@", "h"}], ",", 
             RowBox[{"N", "@", "ns"}], ",", 
             RowBox[{"N", "@", "OmegaM"}], ",", 
             RowBox[{"N", "@", "OmegaB"}], ",", 
             RowBox[{"N", "@", "sigma8"}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"OptionValue", "@", "zInitial"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"{", "z", "}"}]}], 
             RowBox[{"(*", 
              RowBox[{"multiple", " ", "technically", " ", 
               RowBox[{"z", "'"}], "s", " ", "possible"}], "*)"}], ",", 
             RowBox[{"N", "@", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"transfer", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", "kmax"}], "&"}]}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"transfer", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", "kmax"}], "&"}]}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"result", "\[Equal]", "$Failed"}], ",", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{"Interface", "::", "MathLinkFail"}], "]"}], ";", 
             RowBox[{"Return", "[", "$Failed", "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Partition", "[", 
             RowBox[{"result", ",", "3"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P11\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P12\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Copter", "[", "\"\<P22\>\"", "]"}], "\[Rule]", 
             RowBox[{"result", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<NW\>\"", ",", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"Global`CopterNW", "[", 
            RowBox[{
             RowBox[{"N", "@", "h"}], ",", 
             RowBox[{"N", "@", "ns"}], ",", 
             RowBox[{"N", "@", "OmegaM"}], ",", 
             RowBox[{"N", "@", "OmegaB"}], ",", 
             RowBox[{"N", "@", "sigma8"}], ",", 
             RowBox[{"N", "@", "z"}], ",", 
             RowBox[{"OptionValue", "@", "formula"}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"result", "\[Equal]", "$Failed"}], ",", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{"Interface", "::", "MathLinkFail"}], "]"}], ";", 
             RowBox[{"Return", "[", "$Failed", "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Copter", "[", "\"\<P\>\"", "]"}], "\[Rule]", "result"}], 
           "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\"\<Linear\>\"", ",", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"Global`CopterLinear", "[", 
            RowBox[{
             RowBox[{"N", "@", "h"}], ",", 
             RowBox[{"N", "@", "ns"}], ",", 
             RowBox[{"N", "@", "OmegaM"}], ",", 
             RowBox[{"N", "@", "OmegaB"}], ",", 
             RowBox[{"N", "@", "sigma8"}], ",", 
             RowBox[{"N", "@", "z"}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"N", "@", 
              RowBox[{"transfer", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"result", "\[Equal]", "$Failed"}], ",", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{"Interface", "::", "MathLinkFail"}], "]"}], ";", 
             RowBox[{"Return", "[", "$Failed", "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Copter", "[", "\"\<P\>\"", "]"}], "\[Rule]", "result"}], 
           "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "_", 
         ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"Copter", "::", "InvalidType"}], ",", "type", ",", 
            "\"\<\\\"SPT\\\", \\\"RPT\\\", \\\"LPT\\\", \\\"LargeN\\\", \
\\\"HSPT\\\", \\\"FWT\\\", \\\"Linear\\\"\>\""}], "]"}], ";", 
          RowBox[{"Return", "[", "$Failed", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Uninstall", "[", "link", "]"}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "TODO", " ", "truncate", " ", "kvalues", " ", "if", " ", "FWT"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Copter", "[", "\"\<kvalues\>\"", "]"}], "\[Rule]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"type", "\[Equal]", "\"\<FWT\>\""}], ",", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"transfer", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "<", "kmax"}], "&"}]}], 
             "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"transfer", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], "}"}], "~", 
       "Join", "~", "return"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Copter", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"zInitial", "\[Rule]", "100"}], ",", " ", 
     RowBox[{"Neta", "\[Rule]", "50"}], ",", 
     RowBox[{"kcut", "\[Rule]", "10"}], ",", 
     RowBox[{"epsrel", "\[Rule]", "1*^-4"}], ",", 
     RowBox[{"qmin", "\[Rule]", "1*^-4"}], ",", 
     RowBox[{"qmax", "\[Rule]", "100"}], ",", 
     RowBox[{"order", "\[Rule]", "3"}], ",", 
     RowBox[{"formula", "\[Rule]", "1"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CopterGrowth", "[", 
    RowBox[{
    "OmegaM_", ",", "OmegaB_", ",", "h_", ",", "ns_", ",", "z_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"link", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"link", "=", 
       RowBox[{"Install", "[", 
        RowBox[{"$location", "<>", "\"\<ext/math_link\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"Global`CopterGr", "[", 
        RowBox[{
         RowBox[{"N", "@", "h"}], ",", 
         RowBox[{"N", "@", "ns"}], ",", 
         RowBox[{"N", "@", "OmegaM"}], ",", 
         RowBox[{"N", "@", "OmegaB"}], ",", 
         RowBox[{"N", "@", "z"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"result", "\[Equal]", "$Failed"}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"Interface", "::", "MathLinkFail"}], "]"}], ";", 
         RowBox[{"Return", "[", "$Failed", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Uninstall", "[", "link", "]"}], ";", "\[IndentingNewLine]", 
      "result"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["End of package", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"End", "[", " ", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", " ", "]"}]}], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"cosmomathica`interface`Private`\"\>"], "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test", "Section"],

Cell[BoxData[
 RowBox[{"<<", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<interface.m\>\""}], 
   ")"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cl", "=", 
   RowBox[{"CLASS", "[", 
    RowBox[{
     RowBox[{"\"\<h\>\"", " ", "\[Rule]", " ", "\"\<.7\>\""}], ",", 
     RowBox[{"\"\<n_s\>\"", "\[Rule]", "\"\<.9\>\""}], ",", 
     RowBox[{"\"\<output\>\"", "\[Rule]", "\"\<mPk,mTk\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cl", "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(2\\)\[NoBreak] of \
\[NoBreak]\\!\\(Global`Class[\\\"/tmp/m000002258871/mathematica.ini\\\"]\\)\
\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"CLASS", "::", "Error"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(\\\"/tmp/m000002258871/mathematica.ini\\\"\
\\)\[NoBreak] => \
\[NoBreak]\\!\\(\\(\\(Global`Class[\\\"/tmp/m000002258871/mathematica.ini\\\"]\
\\)\\) \[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\[NoBreak]\"\>"}]], \
"Message", "MSG"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Symbol", "::", "argx"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(Symbol\\)\[NoBreak] called with \[NoBreak]\
\\!\\(0\\)\[NoBreak] arguments; 1 argument is expected. \\!\\(\\*ButtonBox[\\\
\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/argx\\\", ButtonNote -> \
\\\"Symbol::argx\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{"Symbol", "[", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"CLASS", "[", "\"\<kvalues\>\"", "]"}], "/.", "cl"}], ",", 
     RowBox[{
      RowBox[{"CLASS", "[", "\"\<linearPk\>\"", "]"}], "/.", "cl"}]}], 
    "}"}]}], "//", "ListPlot"}]], "Input"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJwVkHs01QccwK/n9c7zut73/u7v3jtHGO49N5b2dRshzxJbK+QRl8mQjdS8
NkNaWmd5N4aTzR3aJo4x30K18jiVvF95DEnel8is/fE5n78/H2ZQ9LFQaQqF
InzH/+6gHBeN3ePikEbMXYosDSrHejffuHGxviuSxh+gwdfNvhk6/RxMeJ1h
KhLrQnDhgLbVGQ66fx80XJxCh8MJJ8vdFtg4phw52OOjB4TviFV4PBslc92d
Uqb6IM3zx/Q9Esui/6BZ7+rDC40Jjx+zSFSr/+KvgCcGcHfpzGiTFon71jQ+
yKo0hNKuqci+EhYqeEoxxIlGkFwdur3CZaGwQa2o3d0YArJmM1V/I7Bfwvy5
k2kCh8JEuqYHCZzbuDTZtGECxo4LlR/dZ2J7fP0JDGHALhHFC/RiYt0/Bo/S
uxkwSlm6lzTEwJcXy8ZpB5jQPPa5d14IA9etb4sDy5ggSJxpDR01Qe0M6qC9
EgES3vxI8YoxNsvT076KJaB++dWbZ3LG+NORssbpQQLixMs0ZX0jpCgJuQSw
wDp83UZoYYhmNTdUnlawYIW15ZUoNMDgpXyZc1QS6sZ3oup89ZGeu/SJdxgJ
0UV72bMReqje8O3bX9pIsPCTqTJOpqOzoOjKRQM2LGpSO05c18WX5buCvCg2
iLuVJnNu0ZDuWMH4rpENEdlqe21/6qBlhdODym02mDppGu70aCPv3Fn6UysO
zEnRbK2ntZAu7EgQfMqBWy16vqItTVT14C8y4jhQkWwUV6qiiYyGKEboeQ6w
7Ypy+xka6OUvUnf7mAO1revP9/HVsWo9oStVlwOhbv7tudfVcNP6h/ULtWyw
P5rle6dPBXNmh3J1+Gy4bxXgkF+sjD7pkTWmkyRwJDuN88+UMGn0WpxzPQni
KSmJ90EljPvQxq43j4SyhrqYzRZFzB/2XmhLeddvMT7wxEMR3YLrp1cjSeh0
f1z9cF4BZbccwnT9SLhYeOn9hcsKeCzw8KFaePfztOWOv40CFvQyzRe4JMwx
NgUzY1R0XErS91Ah4eZG5mbxFSru1xI8KF9kgUZ2S9CLQ1TUqeoVEZ0soJ49
v8xflUcPffVy2yoW7ITEmtvdksewrfnzmMaCVvew4bLT8thDm8+vOcUCXuKw
2FJHHi84H88EAQui83IqbnfJYbk/RjzXYsGAWPGbfzPkMCVQvTp9jQCfm16S
NZDDCG5NGq+fgFwz2/fid2SxKcJsz6GVgFQp307RHVnk9V11PVlNgEumk0dL
jCxWfHlALq2QgBGGp62/uSy2rz6cYV8mYP+UZav9vAxGFudo2SURcOSzUj/P
ShlsmqpSvR9OQMhji9jMMzK47eIyNudNwNr0BH/CSAbfXnW/VsAnoOBvk6Oe
Q9Lo4/rIKEuLgOlh1197bkjjTH9J2u+vmKC6/Tr11HFpnE4oIQ3bmPAf12/k
dA==
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{-11.88060311449261, 5.503909132505635},
  Method->{},
  PlotRange->{{-11.88060311449261, -2.290703787904255}, {5.503909132505635, 
   11.227334035294518`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0.1917979865317671, 0.1917979865317671}, {
   0.11446849805577766`, 0.11446849805577766`}}]], "Output"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1680, 991},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowSelection->True,
CellContext->Notebook,
TrackCellChangeTimes->False,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "NaturalColor.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 410, 11, 42, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[992, 35, 54, 1, 78, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1071, 40, 125, 3, 42, "Input",
 InitializationCell->True],
Cell[1199, 45, 58, 0, 42, "Output"]
}, Open  ]],
Cell[1272, 48, 5285, 98, 859, "Input",
 InitializationCell->True],
Cell[6560, 148, 6831, 221, 1209, "Input",
 InitializationCell->True],
Cell[13394, 371, 1790, 50, 241, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[15221, 426, 50, 1, 48, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[15296, 431, 101, 2, 42, "Input",
 InitializationCell->True],
Cell[15400, 435, 66, 0, 42, "Output"]
}, Closed]],
Cell[15481, 438, 156, 4, 39, "Input",
 InitializationCell->True],
Cell[15640, 444, 2522, 76, 131, "Input",
 InitializationCell->True],
Cell[18165, 522, 425, 12, 42, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[18615, 538, 27, 0, 39, "Subsection"],
Cell[18645, 540, 4864, 124, 461, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[23546, 669, 26, 0, 39, "Subsection"],
Cell[23575, 671, 24684, 574, 2133, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[48296, 1250, 30, 0, 31, "Subsection"],
Cell[48329, 1252, 5664, 133, 637, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[54030, 1390, 29, 0, 31, "Subsection"],
Cell[54062, 1392, 9231, 231, 797, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[63330, 1628, 31, 0, 31, "Subsection"],
Cell[63364, 1630, 8520, 223, 593, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[71921, 1858, 32, 0, 31, "Subsection"],
Cell[71956, 1860, 9631, 250, 637, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[81624, 2115, 28, 0, 31, "Subsection"],
Cell[81655, 2117, 21054, 494, 1209, "Input",
 InitializationCell->True],
Cell[102712, 2613, 1421, 35, 175, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[104170, 2653, 36, 0, 31, "Subsection"],
Cell[CellGroupData[{
Cell[104231, 2657, 149, 3, 65, "Input",
 InitializationCell->True],
Cell[104383, 2662, 66, 0, 42, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104510, 2669, 23, 0, 78, "Section"],
Cell[104536, 2671, 156, 5, 42, "Input"],
Cell[CellGroupData[{
Cell[104717, 2680, 415, 11, 65, "Input"],
Cell[105135, 2693, 479, 10, 23, "Message"],
Cell[105617, 2705, 372, 9, 23, "Message"],
Cell[105992, 2716, 451, 9, 23, "Message"],
Cell[106446, 2727, 55, 1, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106538, 2733, 299, 9, 42, "Input"],
Cell[106840, 2744, 2019, 38, 253, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
