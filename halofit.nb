(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     20861,        634]
NotebookOptionsPosition[     19167,        578]
NotebookOutlinePosition[     19605,        595]
CellTagsIndexPosition[     19562,        592]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"BeginPackage", "[", "\"\<Halofit`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.569928839172699*^9, 3.569928853571781*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"HaloFitPS", "::", "usage"}], "=", 
  "\"\<Applies nonlinear corrections using the Halofit algorithm (Smith et al \
2003)\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HaloFitClear", "::", "usage"}], "=", 
  "\"\<Clear memoized functions in order to apply corrections to a new linear \
power spectrum\>\""}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.56992974338654*^9, 3.569929762207574*^9}, {
  3.570167007104711*^9, 3.57016703237261*^9}}],

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"deltaLsq", "[", 
    RowBox[{"k_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"linearPS", "[", "k", "]"}], 
    RowBox[{
     RowBox[{"k", "^", "3"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       RowBox[{"Pi", "^", "2"}]}], ")"}]}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5699273946078587`*^9, 3.5699274111956263`*^9}, {
  3.5699274544209623`*^9, 3.569927471704365*^9}, {3.569930593969412*^9, 
  3.569930596741736*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sigmaSq", "[", 
   RowBox[{"R_", "?", "NumericQ"}], "]"}], " ", ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"deltaLsq", "[", 
      RowBox[{"Exp", "@", "lk"}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Exp", "[", 
         RowBox[{"2", "lk"}], "]"}]}], " ", 
       RowBox[{"R", "^", "2"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"lk", ",", 
      RowBox[{"Log", "[", 
       RowBox[{"10", "^", 
        RowBox[{"-", "6"}]}], "]"}], ",", 
      RowBox[{"Log", "[", 
       RowBox[{"10", "^", "4"}], "]"}]}], "}"}], ",", 
    RowBox[{"PrecisionGoal", "\[Rule]", "5"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.569912221826626*^9, 3.5699123107808313`*^9}, {
   3.569922353176837*^9, 3.569922356645802*^9}, 3.569927296849719*^9, {
   3.569930539586508*^9, 3.569930545182719*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ksig", "[", "]"}], ":=", 
   RowBox[{
    RowBox[{"ksig", "[", "]"}], "=", 
    RowBox[{"x", "/.", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sigmaSq", "[", 
         RowBox[{"1", "/", "x"}], "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "1"}], "}"}]}], "]"}]}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.569912327411026*^9, 3.569912382148163*^9}, {
  3.569929670127451*^9, 3.569929692182122*^9}, {3.569930664055521*^9, 
  3.569930681713606*^9}, {3.570187112481832*^9, 3.570187113689892*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"neff", "[", "]"}], ":=", 
   RowBox[{
    RowBox[{"neff", "[", "]"}], "=", 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"deltaLsq", "[", 
         RowBox[{"Exp", "@", "lk"}], "]"}], "2", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"2", "lk"}], "]"}], "/", 
         RowBox[{
          RowBox[{"ksig", "[", "]"}], "^", "2"}]}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", "lk"}], "]"}]}], "/", 
          RowBox[{
           RowBox[{"ksig", "[", "]"}], "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"lk", ",", 
         RowBox[{"Log", "[", 
          RowBox[{"10", "^", 
           RowBox[{"-", "6"}]}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"10", "^", "4"}], "]"}]}], "}"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "5"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.569914200772037*^9, 3.569914201434308*^9}, {
   3.569923782027894*^9, 3.5699238613429337`*^9}, {3.569925408577142*^9, 
   3.5699254114389887`*^9}, {3.569925456647173*^9, 3.569925473734806*^9}, {
   3.569926838356966*^9, 3.569926920924123*^9}, 3.5699272989131527`*^9, 
   3.5699285736421127`*^9, {3.569929288890428*^9, 3.569929289385232*^9}, {
   3.569929668261063*^9, 3.569929688028455*^9}, 3.5699305517722893`*^9, {
   3.5701871151551447`*^9, 3.5701871162294397`*^9}, {3.570187179623217*^9, 
   3.570187180569878*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"curve", "[", "]"}], ":=", 
   RowBox[{
    RowBox[{"curve", "[", "]"}], "=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"deltaLsq", "[", 
         RowBox[{"Exp", "@", "lk"}], "]"}], "4", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"2", "lk"}], "]"}], "/", 
         RowBox[{
          RowBox[{"ksig", "[", "]"}], "^", "2"}]}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", "lk"}], "]"}]}], "/", 
          RowBox[{
           RowBox[{"ksig", "[", "]"}], "^", "2"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"deltaLsq", "[", 
         RowBox[{"Exp", "@", "lk"}], "]"}], "4", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"4", "lk"}], "]"}], "/", 
         RowBox[{
          RowBox[{"ksig", "[", "]"}], "^", "4"}]}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", "lk"}], "]"}]}], "/", 
          RowBox[{
           RowBox[{"ksig", "[", "]"}], "^", "2"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"lk", ",", 
        RowBox[{"Log", "[", 
         RowBox[{"10", "^", 
          RowBox[{"-", "6"}]}], "]"}], ",", 
        RowBox[{"Log", "[", 
         RowBox[{"10", "^", "4"}], "]"}]}], "}"}], ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "5"}]}], "]"}]}]}], ";"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.569922577699726*^9, 3.569922577795405*^9}, {
   3.56992279201586*^9, 3.5699227925622253`*^9}, {3.569925476252594*^9, 
   3.569925478211525*^9}, {3.5699255208084087`*^9, 3.569925527388686*^9}, 
   3.5699269293051*^9, {3.569927279134431*^9, 3.569927329960972*^9}, 
   3.56992857470683*^9, {3.5699292911751833`*^9, 3.569929291856785*^9}, {
   3.5699296672361813`*^9, 3.5699296898465033`*^9}, 3.569929897659071*^9, 
   3.569930552719041*^9, {3.570187117202914*^9, 3.570187118438323*^9}, {
   3.5701871829712877`*^9, 3.5701871866866493`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"if", " ", "omega_m"}], " ", "<", " ", 
     RowBox[{"1", " ", "and", " ", "lambda"}]}], " ", "=", " ", "0"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f1a", "=", 
     RowBox[{"omegaM", "^", 
      RowBox[{"-", ".0732"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f2a", "=", 
     RowBox[{"omegaM", "^", 
      RowBox[{"-", ".1423"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f3a", "=", 
     RowBox[{"omegaM", "^", ".0725"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.569912712241968*^9, 3.569912763562368*^9}, {
   3.569912889536684*^9, 3.5699128905060663`*^9}, {3.569928755839738*^9, 
   3.569928766909319*^9}, {3.569929560836165*^9, 3.569929563019562*^9}, 
   3.569929663923357*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"if", " ", "omega_m"}], " ", "+", " ", "lambda"}], " ", "=", " ",
     "1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f1b", "=", 
     RowBox[{"omegaM", "^", 
      RowBox[{"-", ".0307"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f2b", "=", 
     RowBox[{"omegaM", "^", 
      RowBox[{"-", ".0585"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f3b", "=", 
     RowBox[{"omegaM", "^", ".0743"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.569912899184643*^9, 3.5699129168069363`*^9}, {
  3.569928778841179*^9, 3.569928789422015*^9}, {3.5699295653164454`*^9, 
  3.5699295703926067`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"interpolation", " ", "of", " ", "the", " ", "two"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "omegaM", "-", "omegaL"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "omegaM"}], ")"}]}], "f1a"}], "+", 
      RowBox[{
       RowBox[{"omegaL", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "omegaM"}], ")"}]}], " ", "f1b"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "omegaM", "-", "omegaL"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "omegaM"}], ")"}]}], "f2a"}], "+", 
      RowBox[{
       RowBox[{"omegaL", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "omegaM"}], ")"}]}], "f2b"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "omegaM", "-", "omegaL"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "omegaM"}], ")"}]}], "f3a"}], "+", 
      RowBox[{
       RowBox[{"omegaL", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "omegaM"}], ")"}]}], "f3b"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5699131126243353`*^9, 3.569913139799076*^9}, {
  3.569913888024103*^9, 3.56991390306218*^9}, {3.569914111469317*^9, 
  3.569914112373084*^9}, {3.5699284725371723`*^9, 3.5699285353856*^9}, {
  3.56992879536819*^9, 3.569928799581205*^9}, {3.569929573307455*^9, 
  3.569929579669231*^9}, {3.569930100645226*^9, 3.56993010389275*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"an", ":=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"1.4861", "+", 
      RowBox[{"1.8369", " ", 
       RowBox[{"neff", "[", "]"}]}], "+", 
      RowBox[{"1.6762", " ", 
       RowBox[{
        RowBox[{"neff", "[", "]"}], "^", "2"}]}], " ", "+", 
      RowBox[{"0.794", 
       RowBox[{
        RowBox[{"neff", "[", "]"}], "^", "3"}]}], "+", 
      RowBox[{"0.167", 
       RowBox[{
        RowBox[{"neff", "[", "]"}], "^", "4"}]}], "-", 
      RowBox[{"0.6206", 
       RowBox[{"curve", "[", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bn", ":=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{".9463", "+", 
      RowBox[{".9466", 
       RowBox[{"neff", "[", "]"}]}], "+", 
      RowBox[{".3084", 
       RowBox[{
        RowBox[{"neff", "[", "]"}], "^", "2"}]}], "-", 
      RowBox[{".94", 
       RowBox[{"curve", "[", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cn", ":=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", ".2807"}], "+", 
      RowBox[{".6669", 
       RowBox[{"neff", "[", "]"}]}], "+", 
      RowBox[{".3214", 
       RowBox[{
        RowBox[{"neff", "[", "]"}], "^", "2"}]}], "-", 
      RowBox[{".0793", 
       RowBox[{"curve", "[", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mun", ":=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3.5442"}], "+", 
      RowBox[{".1908", 
       RowBox[{"neff", "[", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nun", ":=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{".9589", "+", 
      RowBox[{"1.2857", 
       RowBox[{"neff", "[", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamman", ":=", 
   RowBox[{".8649", "+", 
    RowBox[{".2989", 
     RowBox[{"neff", "[", "]"}]}], "+", 
    RowBox[{".1631", 
     RowBox[{"curve", "[", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alphan", ":=", 
   RowBox[{"1.3884", "+", 
    RowBox[{".34", 
     RowBox[{"neff", "[", "]"}]}], "-", 
    RowBox[{".1452", 
     RowBox[{
      RowBox[{"neff", "[", "]"}], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"betan", ":=", 
   RowBox[{".8291", "+", 
    RowBox[{".9854", 
     RowBox[{"neff", "[", "]"}]}], "+", 
    RowBox[{".3401", 
     RowBox[{
      RowBox[{"neff", "[", "]"}], "^", "2"}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.569914299784954*^9, 3.569914360636673*^9}, {
   3.5699222701401157`*^9, 3.569922311266411*^9}, {3.569922353002314*^9, 
   3.569922353087722*^9}, {3.5699223882452707`*^9, 3.5699224690493593`*^9}, {
   3.56992279869665*^9, 3.5699228016816072`*^9}, {3.569928016205483*^9, 
   3.569928073185607*^9}, {3.569928129337319*^9, 3.5699281748277063`*^9}, {
   3.5699286256546497`*^9, 3.569928642184833*^9}, 3.569928675744891*^9, {
   3.569929601683732*^9, 3.5699296534040527`*^9}, {3.5699300309115143`*^9, 
   3.569930047740344*^9}, 3.569930719270055*^9, {3.56993076910822*^9, 
   3.569930818661048*^9}, {3.570187202167687*^9, 3.570187221398521*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deltaHsqPrime", "[", "k_", "]"}], ":=", 
  RowBox[{"an", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"k", "/", 
       RowBox[{"ksig", "[", "]"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"3", "f1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"bn", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"k", "/", 
          RowBox[{"ksig", "[", "]"}]}], ")"}], "^", "f2"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"cn", " ", "f3", " ", 
         RowBox[{"k", "/", 
          RowBox[{"ksig", "[", "]"}]}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"3", "-", "gamman"}], ")"}]}]}], ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.569911749194324*^9, 3.569911830454363*^9}, 
   3.569922353124565*^9, 3.569922401647485*^9, {3.5699280956609364`*^9, 
   3.5699281011484528`*^9}, {3.56992864564325*^9, 3.569928649288377*^9}, {
   3.569930107812923*^9, 3.569930108932005*^9}, {3.570187224536384*^9, 
   3.570187237026484*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deltaHsq", "[", "k_", "]"}], ":=", 
  RowBox[{
   RowBox[{"deltaHsqPrime", "[", "k", "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"ksig", "[", "]"}], "/", "k"}], " ", 
      RowBox[{"(", 
       RowBox[{"mun", "+", " ", 
        RowBox[{"nun", " ", 
         RowBox[{
          RowBox[{"ksig", "[", "]"}], "/", "k"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5699116645581923`*^9, 3.56991174633318*^9}, {
   3.5699281899813757`*^9, 3.5699281926597424`*^9}, {3.569928656427857*^9, 
   3.5699286585442133`*^9}, 3.569930731310356*^9, {3.570187244548831*^9, 
   3.5701872464338284`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "y_", "]"}], ":=", 
   RowBox[{
    RowBox[{"y", "/", "4"}], "+", 
    RowBox[{
     RowBox[{"y", "^", "2"}], "/", "8"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5699116519934187`*^9, 3.569911659778756*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"deltaQsq", "[", "k_", "]"}], ":=", 
   RowBox[{
    RowBox[{"deltaLsq", "[", "k", "]"}], "*", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"deltaLsq", "[", "k", "]"}]}], ")"}], "^", "betan"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"alphan", " ", 
        RowBox[{"deltaLsq", "[", "k", "]"}]}]}], ")"}]}], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{"f", "[", 
       RowBox[{"k", "/", 
        RowBox[{"ksig", "[", "]"}]}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.569911572644882*^9, 3.5699116426288223`*^9}, {
   3.5699282086906433`*^9, 3.569928210867227*^9}, {3.569928665220953*^9, 
   3.5699286674797564`*^9}, 3.570187249218676*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"deltaNLsq", "[", "k_", "]"}], ":=", 
   RowBox[{
    RowBox[{"deltaQsq", "[", "k", "]"}], "+", 
    RowBox[{"deltaHsq", "[", "k", "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.569911538847855*^9, 3.569911569485448*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nonlinearPS", "[", "k_", "]"}], ":=", 
   RowBox[{
    RowBox[{"deltaNLsq", "[", "k", "]"}], "*", "2", 
    RowBox[{
     RowBox[{"Pi", "^", "2"}], "/", 
     RowBox[{"k", "^", "3"}]}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5699274752812023`*^9, 3.569927499008065*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HaloFitPS", "[", 
    RowBox[{
     RowBox[{"k_", "?", "NumericQ"}], ",", "OmegaM_", ",", "OmegaL_", ",", 
     "LinearPS_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"linearPS", "=", "LinearPS"}], ",", 
       RowBox[{"omegaM", "=", "OmegaM"}], ",", 
       RowBox[{"omegaL", "=", "OmegaL"}]}], "}"}], ",", 
     RowBox[{"nonlinearPS", "[", "k", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.569929336383263*^9, 3.569929437575612*^9}, {
  3.569929486415183*^9, 3.5699294868812113`*^9}, {3.569932376462575*^9, 
  3.569932381581608*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"clear", " ", "memoized", " ", "variables"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"HaloFitClear", "[", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"DownValues", "[", "#", "]"}], "=", 
         RowBox[{"{", 
          RowBox[{"Last", "@", 
           RowBox[{"DownValues", "[", "#", "]"}]}], "}"}]}], ";"}], ")"}], 
      "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"curve", ",", "neff", ",", "ksig"}], "}"}]}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.570166961691329*^9, 3.570166996170624*^9}, {
   3.570184877845677*^9, 3.570184880976582*^9}, {3.570186187734106*^9, 
   3.5701862296815443`*^9}, {3.570186273614937*^9, 3.5701862953197937`*^9}, {
   3.570186729290638*^9, 3.570186729765212*^9}, {3.570186947744093*^9, 
   3.570186954192051*^9}, {3.570187258605585*^9, 3.5701872904610233`*^9}, 
   3.57018837379772*^9}],

Cell[BoxData[{
 RowBox[{"End", "[", " ", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", " ", "]"}]}], "Input",
 InitializationCell->True]
},
AutoGeneratedPackage->Automatic,
WindowSize->{832, 981},
WindowMargins->{{Automatic, 1}, {Automatic, 0}},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (October 10, 2011)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "NaturalColor.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 173, 3, 49, "Input",
 InitializationCell->True],
Cell[733, 25, 501, 11, 165, "Input",
 InitializationCell->True],
Cell[1237, 38, 101, 2, 49, "Input",
 InitializationCell->True],
Cell[1341, 42, 523, 15, 49, "Input",
 InitializationCell->True],
Cell[1867, 59, 925, 26, 96, "Input",
 InitializationCell->True],
Cell[2795, 87, 637, 17, 49, "Input",
 InitializationCell->True],
Cell[3435, 106, 1611, 42, 142, "Input",
 InitializationCell->True],
Cell[5049, 150, 2091, 56, 211, "Input",
 InitializationCell->True],
Cell[7143, 208, 863, 24, 119, "Input",
 InitializationCell->True],
Cell[8009, 234, 757, 22, 119, "Input",
 InitializationCell->True],
Cell[8769, 258, 1784, 53, 119, "Input",
 InitializationCell->True],
Cell[10556, 313, 3199, 97, 257, "Input",
 InitializationCell->True],
Cell[13758, 412, 1065, 30, 96, "Input",
 InitializationCell->True],
Cell[14826, 444, 724, 20, 49, "Input",
 InitializationCell->True],
Cell[15553, 466, 293, 9, 49, "Input",
 InitializationCell->True],
Cell[15849, 477, 815, 23, 96, "Input",
 InitializationCell->True],
Cell[16667, 502, 297, 8, 49, "Input",
 InitializationCell->True],
Cell[16967, 512, 348, 10, 49, "Input",
 InitializationCell->True],
Cell[17318, 524, 683, 18, 96, "Input",
 InitializationCell->True],
Cell[18004, 544, 1007, 27, 96, "Input",
 InitializationCell->True],
Cell[19014, 573, 149, 3, 73, "Input",
 InitializationCell->True]
}
]
*)

(* End of internal cache information *)
